# Setup Google Ads Credentials Command

You are helping the user set up their Google Ads API credentials for the MCP server.

## What This Does

This command creates the `google-ads.yaml` credentials file in the plugin directory so the Google Ads MCP server can connect to their account.

## Prerequisites Check

First, verify the user has completed the GCP OAuth setup:

1. Ask: "Have you completed the Google Cloud Platform (GCP) setup to get your OAuth credentials?"
   - If NO: Direct them to COMPLETE_SETUP_GUIDE.md
   - If YES: Continue

2. Verify they have these values ready:
   - OAuth Client ID
   - OAuth Client Secret
   - OAuth Refresh Token
   - Google Ads Developer Token
   - (Optional) Login Customer ID (MCC account)

## Steps

### Step 1: Find Plugin Directory

Determine where the plugin is installed:

```bash
# Find the plugin installation directory
find ~/.claude/plugins -name "google-ads-mcp*" -type d 2>/dev/null | head -1
```

Store this as `PLUGIN_DIR`.

### Step 2: Collect Credentials

Ask the user for each credential interactively:

```
Let's set up your Google Ads API credentials.

Please provide the following (from your GCP OAuth setup):

1. OAuth Client ID (looks like: xxxxx.apps.googleusercontent.com):
```

Wait for input, then ask for:

```
2. OAuth Client Secret (looks like: GOCSPX-xxxxx):
```

```
3. OAuth Refresh Token (looks like: 1//0gxxxxx):
```

```
4. Google Ads Developer Token (from Google Ads API Center):
```

```
5. (Optional) Login Customer ID - MCC account ID without dashes (press Enter to skip):
```

### Step 3: Create google-ads.yaml

Write the credentials to `{PLUGIN_DIR}/google_ads_mcp/google-ads.yaml`:

```yaml
# Google Ads API Configuration
# Auto-generated by /setup-google-ads-credentials

# OAuth2 Client ID from Google Cloud Console
client_id: [USER_PROVIDED_CLIENT_ID]

# OAuth2 Client Secret from Google Cloud Console
client_secret: [USER_PROVIDED_CLIENT_SECRET]

# OAuth2 Refresh Token
refresh_token: [USER_PROVIDED_REFRESH_TOKEN]

# Developer Token from Google Ads API Center
developer_token: [USER_PROVIDED_DEVELOPER_TOKEN]

# Required: Use proto-plus messages
use_proto_plus: True

# Optional: Login Customer ID (MCC account)
# login_customer_id: [USER_PROVIDED_MCC_ID]
```

If user provided MCC ID, uncomment and fill in the last line.

### Step 4: Verify File Created

```bash
ls -la {PLUGIN_DIR}/google_ads_mcp/google-ads.yaml
```

### Step 5: Test Connection

Try to list accessible accounts using the MCP:

Use tool: `mcp__google-ads__list_accessible_accounts`

If successful:
```
‚úÖ Credentials saved and tested successfully!

Your Google Ads MCP is now configured.

Run /test-google-ads-connection to see your accessible accounts.
```

If failed:
```
‚ö†Ô∏è Credentials saved but connection test failed.

Possible issues:
- Check your credentials are correct
- Verify your developer token is valid
- Make sure you have Google Ads account access

Run /test-google-ads-connection for detailed diagnostics.
```

## Error Handling

### Path doesn't exist
‚Üí "I couldn't find the MCP server at that path. Please check the path and try again."

### google-ads.yaml missing
‚Üí "The MCP server isn't fully set up. Please complete COMPLETE_SETUP_GUIDE.md first."

### JSON syntax error
‚Üí Offer to fix the mcp_settings.json file

## Output Format

Show the user:
1. ‚úÖ What you're doing at each step
2. üìù The exact file contents you're writing
3. ‚ö†Ô∏è Any warnings or next steps
4. üéâ Success message with verification steps

## Important Notes

- Always ask before modifying files
- Show the user what you're adding to mcp_settings.json
- Preserve any existing MCP servers they have configured
- Use the EXACT path the user provides (don't guess)
